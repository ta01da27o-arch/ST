<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>STシミュレーター ○右端0.00版</title>
<style>
html, body {
  margin:0; padding:0; width:100%; height:100%;
  font-family:sans-serif; background:#fff; overflow:hidden;
}
.table-container {
  display:flex; flex-direction:column; justify-content:space-between;
  height:100%; padding:10px; gap:10px;
}
.panel {
  background:#00bfff; border:2px solid #00796b;
  border-radius:10px; display:flex; flex-direction:row;
  position:relative; flex:1; max-height:calc(50% - 14px);
}
.line {
  position:absolute; top:0; bottom:0; width:2px; background:#000;
  left:50%; z-index:0;
}
.number-labels {
  display:flex; flex-direction:column; justify-content:space-around;
  height:100%; width:20px;
  z-index:1;
}
.circles-column {
  display:flex; flex-direction:column; justify-content:space-around;
  align-items:flex-start; flex:1; position:relative;
  z-index:2;
}
.circle {
  width:24px; height:24px; border-radius:50%;
  cursor:grab; border:1px solid #000; position:absolute; transition:left 0.05s;
  z-index:2;
}
.inputs-column {
  display:flex; flex-direction:column; justify-content:space-around;
  height:100%; width:60px;
  z-index:2;
}
.inputs-column input {
  width:100%; padding:5px; text-align:center; font-size:0.9rem;
}
</style>
</head>
<body>

<div class="table-container">

  <!-- 上段 -->
  <div class="panel" id="average-panel">
    <div class="line"></div>
    <div class="number-labels">
      <div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div>
    </div>
    <div class="circles-column" id="average-circles">
      <span class="circle" style="background:white;" data-index="0"></span>
      <span class="circle" style="background:black;" data-index="1"></span>
      <span class="circle" style="background:red;" data-index="2"></span>
      <span class="circle" style="background:blue;" data-index="3"></span>
      <span class="circle" style="background:yellow;" data-index="4"></span>
      <span class="circle" style="background:green;" data-index="5"></span>
    </div>
    <div class="inputs-column" id="average-inputs">
      <input type="text" id="avg1" placeholder="0.00">
      <input type="text" id="avg2" placeholder="0.00">
      <input type="text" id="avg3" placeholder="0.00">
      <input type="text" id="avg4" placeholder="0.00">
      <input type="text" id="avg5" placeholder="0.00">
      <input type="text" id="avg6" placeholder="0.00">
    </div>
  </div>

  <!-- 下段 -->
  <div class="panel" id="display-panel">
    <div class="line"></div>
    <div class="number-labels">
      <div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div>
    </div>
    <div class="circles-column" id="display-circles">
      <span class="circle" style="background:white;" data-index="0"></span>
      <span class="circle" style="background:black;" data-index="1"></span>
      <span class="circle" style="background:red;" data-index="2"></span>
      <span class="circle" style="background:blue;" data-index="3"></span>
      <span class="circle" style="background:yellow;" data-index="4"></span>
      <span class="circle" style="background:green;" data-index="5"></span>
    </div>
    <div class="inputs-column" id="display-inputs">
      <input type="text" id="disp1" placeholder="0.00">
      <input type="text" id="disp2" placeholder="0.00">
      <input type="text" id="disp3" placeholder="0.00">
      <input type="text" id="disp4" placeholder="0.00">
      <input type="text" id="disp5" placeholder="0.00">
      <input type="text" id="disp6" placeholder="0.00">
    </div>
  </div>

</div>

<script>
function setupPanel(panelId,inputIds){
  const panel=document.getElementById(panelId);
  const inputs=inputIds.map(id=>document.getElementById(id));
  const circles=panel.querySelectorAll('.circle');

  const minValue=-0.50;
  const maxValue=0.50;
  const zeroPos=panel.clientWidth/2; // 中央ライン
  const leftPixels=zeroPos-0; // 左側
  const rightPixels=panel.clientWidth-zeroPos-24; // 右側

  // 初期配置: 横0.00 右端が中央ライン
  circles.forEach((circle,idx)=>{
    const vertPos=idx*(panel.clientHeight/6)+(panel.clientHeight/12-circle.offsetHeight/2);
    circle.style.top=`${vertPos}px`;
    // ○の右端を中央に合わせる
    circle.style.left=`${zeroPos - circle.offsetWidth}px`;
    circle.dataset.value=0.0;
  });

  // 入力連動
  inputs.forEach((input,idx)=>{
    input.addEventListener('input',()=>{
      let val=parseFloat(input.value);
      if(isNaN(val)) val=0;
      if(val<minValue) val=minValue;
      if(val>maxValue) val=maxValue;
      const px = val<0 ? zeroPos + val/minValue*leftPixels - circles[idx].offsetWidth
                        : zeroPos + val/maxValue*rightPixels - circles[idx].offsetWidth;
      circles[idx].style.left=`${px}px`;
      circles[idx].dataset.value=val;
      input.value=val.toFixed(2);
    });
  });

  // ドラッグ
  circles.forEach((circle,idx)=>{
    let dragging=false, startX=0, startValue=0;
    const moveCircle=(x)=>{
      let delta=x-startX;
      let newValue=startValue + (startValue<0 ? delta/leftPixels*minValue : delta/rightPixels*maxValue);
      if(newValue<minValue)newValue=minValue;
      if(newValue>maxValue)newValue=maxValue;
      const px = newValue<0 ? zeroPos + newValue/minValue*leftPixels - circle.offsetWidth
                            : zeroPos + newValue/maxValue*rightPixels - circle.offsetWidth;
      circle.style.left=`${px}px`;
      circle.dataset.value=newValue;
      inputs[idx].value=newValue.toFixed(2);
    };
    circle.addEventListener('mousedown',e=>{
      dragging=true; startX=e.clientX;
      startValue=parseFloat(circle.dataset.value);
      circle.style.cursor='grabbing';
    });
    document.addEventListener('mousemove',e=>{if(dragging)moveCircle(e.clientX);});
    document.addEventListener('mouseup',e=>dragging=false);
    circle.addEventListener('touchstart',e=>{
      dragging=true; startX=e.touches[0].clientX;
      startValue=parseFloat(circle.dataset.value);
    });
    document.addEventListener('touchmove',e=>{if(dragging){e.preventDefault(); moveCircle(e.touches[0].clientX);}}, {passive:false});
    document.addEventListener('touchend',e=>dragging=false);
  });
}

setupPanel('average-panel',['avg1','avg2','avg3','avg4','avg5','avg6']);
setupPanel('display-panel',['disp1','disp2','disp3','disp4','disp5','disp6']);
</script>

</body>
</html>